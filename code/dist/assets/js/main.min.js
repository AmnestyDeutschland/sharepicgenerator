const draw=SVG().addTo("#canvas");var info={foo:null};const bgpic={width:800,height:450,originalWidth:1920,originalHeight:1080,filename:"assets/bg_small.jpg"};function message(a=!1){a?$("#message").show().html(a):$("#message").hide()}function setDrawsize(){let a=$("#width").val(),e=$("#height").val(),t=a/e;a>800&&(e=(a=800)/t),draw.size(a,e),$("#canvas").width(draw.width()),$("#canvas").height(draw.height()),calculateSizes(),text.bounce(),pin.bounce(),subline.draw(),window.setTimeout(logo.draw,100)}function resetDrawsize(){$("#width").val(info.originalWidth),$("#height").val(info.originalHeight),setDrawsize()}function calculateSizes(){$("#textsize").attr("min",.2*draw.width()),$("#textsize").attr("max",draw.width()),$("#textsize").val(.5*draw.width()),$("#textX").val(0),$("#textY").val(draw.height()/2),$("#pinsize").attr("min",Math.max(50,.1*draw.width())),$("#pinsize").attr("max",Math.max(50,.25*draw.width())),$("#pinsize").val(.175*draw.width()),$("#pinX").val(.7*draw.width()),$("#pinY").val(.5*draw.height()),$("#backgroundsize").attr("min",draw.width()),$("#backgroundsize").attr("max",5*draw.width()),$("#backgroundsize").val(draw.width()),$("#backgroundX").val(0),$("#backgroundY").val(0)}function uploadImageByUrl(a,e=function(){}){$("#waiting").addClass("active");var t=new XMLHttpRequest;t.open("GET",a,!0),t.responseType="blob",t.onload=function(){let a=new FileReader;a.onload=function(){$.post("upload.php",{data:a.result}).done(function(a){let t=JSON.parse(a);$(".overlay.active").removeClass("active"),afterUpload(t),e()})},a.readAsDataURL(t.response)},t.send()}function afterUpload(a){draw.size(a.width,a.height),info.originalWidth=a.originalWidth,info.originalHeight=a.originalHeight,info.previewWidth=draw.width(),info.previewHeight=draw.height(),background.filename=a.filename,$("#width").val(a.originalWidth),$("#height").val(a.originalHeight),setDrawsize(),background.draw(),pin.draw(),window.setTimeout(text.draw,10)}$(document).ready(function(){afterUpload(bgpic),$("#text").val("!Leben\nlassen")}),$(".close").click(function(){$(".overlay.active").removeClass("active")}),$(".size").bind("input propertychange",setDrawsize),$("#sizereset").click(resetDrawsize),$("#download").click(function(){$(this).prop("disabled",!0);let a=$(this).html();$(this).html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Augenblick bitte'),$("#canvas").addClass("opacity");let e=draw.svg();$.ajax({type:"POST",url:"createpic.php",data:{svg:e,format:"png",width:$("#width").val()},success:function(e,t,i){let n=JSON.parse(e);$("#download").prop("disabled",!1),$("#canvas").removeClass("opacity"),$("#download").html(a),window.location.href="download.php?file="+n.basename+"&format=png"}})}),$("#uploadfile").change(function(a){$("#uploadfile").prop("disabled",!0),$("#upload .message").html('<br><span>Augenblick bitte ...</span><div class="spinner-border" role="status"></div>'),$("#canvas").addClass("opacity");let e=a.target,t=new FileReader;t.onload=function(){$.post("upload.php",{data:t.result}).done(function(a){let e=JSON.parse(a);$("#uploadfile").prop("disabled",!1),$("#upload .message").html(""),$("#canvas").removeClass("opacity"),afterUpload(e)})},t.readAsDataURL(e.files[0])});const background={svg:draw.circle(0),isLoaded:!1,draw(){this.svg.remove(),this.svg=draw.image(this.filename,function(a){this.back().draggable(),background.isLoaded=!0,background.resize(),background.svg.move(parseInt($("#backgroundX").val()),parseInt($("#backgroundY").val())),this.on("dragend.namespace",function(a){$("#backgroundX").val(this.x()),$("#backgroundY").val(this.y()),background.bounceWarning()})})},reset:function(){$("#backgroundX").val(0),$("#backgroundY").val(0),$("#backgroundsize").val(parseInt($("#backgroundsize").prop("min"))),this.draw(),background.bounceWarning()},resize:function(){let a=parseInt($("#backgroundsize").val());this.svg.size(a),background.bounceWarning()},bounceWarning:function(){if(!this.isLoaded)return!1;let a=!1;this.svg.x()>0&&(a=!0),this.svg.x()+this.svg.width()<draw.width()&&(a=!0),this.svg.y()>0&&(a=!0),this.svg.y()+this.svg.height()<draw.height()&&(a=!0),a?message('Im Bild entsteht ein weißer Rand. Platziere das Bild neu, <u class="cursor-pointer" onClick="background.reset();">setze es zurück</u> oder vergrößere es.'):message()}};$("#backgroundreset").click(function(){background.reset()}),$("#backgroundsize").bind("input propertychange",function(){background.resize()});const text={svg:draw.text(""),lineheights:[26,40],colors:["#449d2f","#255119"],fontsizes:[23,40],yBiases:[0,-3],linemargin:4,paddingLr:5,font:{family:"Arvo",anchor:"left",leading:"1.25em",weight:"bold"},draw:function(){text.svg.remove(),text.svg=draw.group().addClass("draggable").draggable(),text.svg.on("dragend.namespace",function(a){$("#textX").val(this.x()),$("#textY").val(this.y()),text.bounce()});let a=0;$("#text").val().split(/\n/).forEach(function(e,t,i){let n=/^!/.test(e)?1:0;e=e.replace(/^!/,"").toUpperCase();let s=draw.text(e).font({...text.font,...{size:text.fontsizes[n]}}).fill(text.colors[n]).move(0,a+text.yBiases[n]),r=draw.rect(s.length()+2*text.paddingLr,text.lineheights[n]).fill("white").move(-text.paddingLr,a);text.svg.add(r).add(s),a+=text.lineheights[n]+text.linemargin}),text.svg.move(parseInt($("#textX").val()),parseInt($("#textY").val())).size(parseInt($("#textsize").val()))},bounce:function(){this.svg.x()<15&&($("#textX").val(15),this.draw()),this.svg.x()>draw.width()-this.svg.width()-15&&($("#textX").val(draw.width()-this.svg.width()-15),this.draw()),this.svg.y()<30&&($("#textY").val(30),this.draw()),this.svg.y()>draw.height()-this.svg.height()-30&&($("#textY").val(draw.height()-this.svg.height()-30),this.draw())}};$("#text").bind("input propertychange",text.draw),$("#textsize").bind("input propertychange",text.draw);const logo={isLoaded:!1,svg:draw.image("assets/sonnenblume.svg",function(a){logo.isLoaded=!0}),draw(){if(!logo.isLoaded)return!1;let a=Math.max(50,.1*draw.width());logo.svg.size(a).x(draw.width()-a-10).y(10)}};var claim=draw.text("AM 15. MÄRZ GRÜN WÄHLEN.").fill("white").move(15,15);claim.font({family:"Arvo",size:15,anchor:"left",weight:700}),$("#pinsize").bind("input propertychange",function(){pin.draw()});const pin={isLoaded:!1,svg:draw.image("assets/pin.svg",function(a){pin.isLoaded=!0,this.on("dragend.namespace",function(a){$("#pinX").val(this.x()),$("#pinY").val(this.y()),pin.bounce()}),pin.draw()}).addClass("draggable").draggable(),draw(){if(!this.isLoaded)return!1;pin.svg.move(parseInt($("#pinX").val()),parseInt($("#pinY").val())),pin.svg.size(parseInt($("#pinsize").val()))},bounce:function(){if(!this.isLoaded)return!1;this.svg.x()<15&&($("#pinX").val(15),this.draw()),this.svg.x()>draw.width()-this.svg.width()-15&&($("#pinX").val(draw.width()-this.svg.width()-15),this.draw()),this.svg.y()<30&&($("#pinY").val(30),this.draw()),this.svg.y()>draw.height()-this.svg.height()-30&&($("#pinY").val(draw.height()-this.svg.height()-30),this.draw())}},subline={svg:draw.circle(0),draw(){subline.svg.remove(),subline.svg=draw.text($("#subline").val().toUpperCase()).fill("white").move(15,draw.height()-24).font({family:"Arvo",size:15,anchor:"left",weight:700})}};$("#subline").bind("input propertychange",subline.draw),$("#pixabayopener").click(function(){$("#pixabay").addClass("active")}),$("#pixabay>form").submit(function(){return getPixabayImages($("#pixabay .q").val()),!1});var pixabayAPIKey="1309982-0e2df8b488eca18e61116743a",page=1;function getPixabayImages(a){let e="https://pixabay.com/api/?key="+pixabayAPIKey+"&q="+encodeURIComponent(a)+"&image_type=photo&page="+page+"&per_page=100";$.ajax({url:e,success:function(a,e,t){$("#pixabay .results").html(""),a.hits.forEach(function(a){$("#pixabay .results").append('<img src="'+a.previewURL+'" data-url="'+a.largeImageURL+'">')}),$("#pixabay .results>img").click(function(){uploadImageByUrl($(this).data("url"))})},error:function(a,e,t){console.log(a,t)}})}function build(){uploadImageByUrl("persistent/fox.jpg",function(){$("#textX").val(10),$("#textY").val(290),$("#textsize").val(211),$("#pinX").val(510),$("#pinY").val(270),$("#backgroundX").val(-500),$("#backgroundY").val(-500),$("#backgroundsize").val(1700),$("#text").val("Das ist ein\n!Fuchs"),pin.draw()})}
//# sourceMappingURL=main.min.js.map