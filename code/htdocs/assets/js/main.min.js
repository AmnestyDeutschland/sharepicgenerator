const draw=SVG().addTo("#canvas");var info={foo:null};const bgpic={width:800,height:450,originalWidth:1920,originalHeight:1080,filename:"assets/bg_small.jpg"};function setDrawsize(){let e=$("#width").val(),a=$("#height").val();draw.size(e,a),$("#canvas").height(draw.height()),logo.draw(),subline.draw()}function uploadImageByUrl(e,a=function(){}){$("#waiting").addClass("active");var t=new XMLHttpRequest;t.open("GET",e,!0),t.responseType="blob",t.onload=function(){let e=new FileReader;e.onload=function(){$.post("upload.php",{data:e.result}).done(function(e){let t=JSON.parse(e);$(".overlay.active").removeClass("active"),afterUpload(t),a()})},e.readAsDataURL(t.response)},t.send()}function afterUpload(e){draw.size(e.width,e.height),info.originalWidth=e.originalWidth,info.originalHeight=e.originalHeight,background.filename=e.filename,$("#width").val(draw.width()),$("#height").val(draw.height()),calculateSizes(),setDrawsize(),background.draw(),pin.draw(),window.setTimeout(text.draw,10)}function calculateSizes(){$("#textsize").attr("min",.2*draw.width()),$("#textsize").attr("max",draw.width()),$("#textsize").val(.5*draw.width()),$("#textX").val(0),$("#textY").val(draw.height()/2),$("#pinsize").attr("min",.1*draw.width()),$("#pinsize").attr("max",.25*draw.width()),$("#pinsize").val(.175*draw.width()),$("#pinX").val(draw.width()/2),$("#pinY").val(draw.height()/2),$("#backgroundsize").attr("min",draw.width()),$("#backgroundsize").attr("max",5*draw.width()),$("#backgroundsize").val(draw.width()),$("#backgroundX").val(0),$("#backgroundY").val(0)}$(document).ready(function(){afterUpload(bgpic)}),$(".close").click(function(){$(".overlay.active").removeClass("active")}),$(".size").bind("input propertychange",setDrawsize),$("#download").click(function(){$(this).prop("disabled",!0);let e=$(this).html();$(this).html("Augenblick bitte");let a=draw.svg();$.ajax({type:"POST",url:"createpic.php",data:{svg:a,format:"png",width:info.originalWidth},success:function(a,t,i){let n=JSON.parse(a);$("#download").prop("disabled",!1),$("#download").html(e),window.location.href="download.php?file="+n.basename+"&format=png"}})}),$("#uploadfile").change(function(e){$("#uploadfile").prop("disabled",!0),$("#upload .message").html("Lade hoch...");let a=e.target,t=new FileReader;t.onload=function(){$.post("upload.php",{data:t.result}).done(function(e){let a=JSON.parse(e);$("#uploadfile").prop("disabled",!1),$("#upload .message").html(""),afterUpload(a)})},t.readAsDataURL(a.files[0])});const background={svg:draw.circle(0),draw(){this.svg.remove(),this.svg=draw.image(this.filename,function(e){this.back().draggable(),background.resize(),this.on("dragend.namespace",function(e){$("#backgroundX").val(this.x()),$("#backgroundY").val(this.y())})})},reset:function(){$("#backgroundX").val(0),$("#backgroundY").val(0),$("#backgroundsize").val(parseInt($("#backgroundsize").prop("min"))),this.draw()},resize:function(){let e=parseInt($("#backgroundsize").val());this.svg.size(e)}};$("#backgroundreset").click(function(){background.reset()}),$("#backgroundsize").bind("input propertychange",function(){background.resize()});const text={svg:draw.text("dd"),lineheights:[26,40],colors:["#449d2f","#255119"],fontsizes:[23,40],yBiases:[0,-3],linemargin:4,paddingLr:5,font:{family:"Arvo",anchor:"left",leading:"1.25em",weight:"bold"},draw:function(){text.svg.remove(),text.svg=draw.group().addClass("draggable").draggable(),text.svg.on("dragend.namespace",function(e){$("#textX").val(this.x()),$("#textY").val(this.y())});let e=0;$("#text").val().split(/\n/).forEach(function(a,t,i){let n=/^!/.test(a)?1:0;a=a.replace(/^!/,"");let s=draw.text(a).font({...text.font,...{size:text.fontsizes[n]}}).fill(text.colors[n]).move(0,e+text.yBiases[n]),r=draw.rect(s.length()+2*text.paddingLr,text.lineheights[n]).fill("white").move(-text.paddingLr,e);text.svg.add(r).add(s),e+=text.lineheights[n]+text.linemargin}),text.svg.move(parseInt($("#textX").val()),parseInt($("#textY").val())).size(parseInt($("#textsize").val()))}};$("#text").bind("input propertychange",text.draw),$("#textsize").bind("input propertychange",text.draw),$("#textfieldresize").bind("input propertychange",function(){let e=parseInt($(this).val());textfield.size(e),info.size=e});const logo={isLoaded:!1,svg:draw.image("assets/sonnenblume.svg",function(e){logo.isLoaded=!0,logo.draw()}),draw:function(e){if(!logo.isLoaded)return!1;let a=.1*draw.width();this.svg.size(a).x(draw.width()-a-10).y(10)}};var claim=draw.text("AM 15. MÄRZ GRÜN WÄHLEN.").fill("white").move(15,15);claim.font({family:"Arvo",size:15,anchor:"left",weight:700}),$("#pinsize").bind("input propertychange",function(){pin.draw()});const pin={isLoaded:!1,svg:draw.image("assets/pin.svg",function(e){pin.isLoaded=!0,this.on("dragend.namespace",function(e){$("#pinX").val(this.x()),$("#pinY").val(this.y())}),pin.draw()}).addClass("draggable").draggable(),draw(){if(!this.isLoaded)return!1;this.svg.move(parseInt($("#pinX").val()),parseInt($("#pinY").val())),this.svg.size(parseInt($("#pinsize").val()))}},subline={svg:draw.circle(0),draw(){this.svg.remove(),this.svg=draw.text($("#subline").val().toUpperCase()).fill("white").move(15,draw.height()-24).font({family:"Arvo",size:15,anchor:"left",weight:700})}};$("#subline").bind("input propertychange",subline.draw),$("#pixabayopener").click(function(){$("#pixabay").addClass("active")}),$("#pixabay>form").submit(function(){return getPixabayImages($("#pixabay>form>.q").val()),!1});var pixabayAPIKey="1309982-0e2df8b488eca18e61116743a",page=1;function getPixabayImages(e){let a="https://pixabay.com/api/?key="+pixabayAPIKey+"&q="+encodeURIComponent(e)+"&image_type=photo&page="+page+"&per_page=50";$.ajax({url:a,success:function(e,a,t){$("#pixabay>.results").html(""),e.hits.forEach(function(e){$("#pixabay>.results").append('<img src="'+e.previewURL+'" data-url="'+e.largeImageURL+'">')}),$("#pixabay>.results>img").click(function(){uploadImageByUrl($(this).data("url"))})}})}function build(){uploadImageByUrl("persistent/fox.jpg",function(){$("#textX").val(10),$("#textY").val(290),$("#textsize").val(211),$("#pinX").val(510),$("#pinY").val(270),$("#text").val("Das ist ein\n!Fuchs"),pin.draw()})}build();
//# sourceMappingURL=main.min.js.map