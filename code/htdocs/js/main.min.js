var draw=SVG().addTo("#canvas").size(info.width,info.height),bgpic={width:800,height:450,originalWidth:1920,originalHeight:1080,filename:"assets/bg_small.jpg"};$(document).ready(function(){afterUpload(bgpic),handleSubline()}),$("#download").click(function(){$(this).prop("disabled",!0);let e=$(this).html();$(this).html("... Augenblick bitte");let i=draw.svg();$.ajax({type:"POST",url:"savesvg.php",data:{svg:i},success:function(i){let t=JSON.parse(i);$(this).prop("disabled",!1),$(this).html(e),window.location.href="download.php?file="+t.basename+"&width="+info.originalWidth}})}),$("#uploadfile").change(function(e){let i=e.target,t=new FileReader;t.onload=function(){t.result;$.post("upload.php",{data:t.result}).done(function(e){afterUpload(JSON.parse(e))})},t.readAsDataURL(i.files[0])});var image=draw.circle(0);function afterUpload(e){draw.size(e.width,e.height),info.originalWidth=e.originalWidth,info.originalHeight=e.originalHeight,image.remove(),image=draw.image(e.filename,function(e){image.size(draw.width(),draw.height()),$("#textfieldresize").attr("max",draw.width()),image.back(),setLogoPosition(),handleSubline()})}var logo,textfield=draw.group();function handleText(){let e=[],i=[],t=$("#text").val().split(/\n/),a=["#449d2f","#255119"],n=[20,40],l=[30,60],o=[0,-8],d=0;textfield.remove(),textfield=draw.group().draggable();for(let r=0;r<t.length;r++){let s=t[r].toUpperCase(),f=0;"!"==s.substring(0,1)&&(s=s.substring(1),f=1);let h=a[f],g=n[f],p=l[f],w=o[f];e[r]=draw.text(s).fill(h).move(5,d+w),e[r].font({family:"Arvo",size:g,anchor:"left",leading:"1.5em",weight:"bold"}),i[r]=draw.rect(e[r].length()+10,p).fill("white").move(0,d),d+=p+4,textfield.add(i[r]).add(e[r])}setPositionOfTextfield(),$("#textfieldresize").val(textfield.width())}function setPositionOfTextfield(){textfield.x(info.x),textfield.y(info.y),textfield.size(info.size),textfield.front()}function setLogoPosition(){logo.x(draw.width()-logo.width()-10).y(10)}$("#text").bind("input propertychange",handleText),handleText(),textfield.on("dragend.namespace",function(e){info.x=textfield.x(),info.y=textfield.y()}),$("#textfieldresize").bind("input propertychange",function(){let e=parseInt($("#textfieldresize").val());textfield.size(e),info.size=e}),logo=draw.image("assets/sonnenblume.svg",function(e){logo.size(100,100).x(draw.width()-110).y(10)});var claim=draw.text("AM 15. MÄRZ GRÜN WÄHLEN.").fill("white").move(15,15);claim.font({family:"Arvo",size:15,anchor:"left",weight:600});var pin=draw.image("assets/pin.svg",function(e){pin.size(100).move(draw.width()/2,draw.height()/2),pin.draggable()});$("#subline").bind("input propertychange",handleSubline);var subline=draw.text("");function handleSubline(){subline.remove(),(subline=draw.text($("#subline").val().toUpperCase()).fill("white").move(15,draw.height()-24)).font({family:"Arvo",size:15,anchor:"left",weight:600})}