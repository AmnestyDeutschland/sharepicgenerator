var draw=SVG().addTo("#canvas").size(info.width,info.height),bgpic={width:640,height:360,filename:"assets/bg.jpg"};$(document).ready(function(){afterUpload(bgpic),handleSubline()}),$("#download").click(function(){let e=draw.svg();$.ajax({type:"POST",url:"savesvg.php",data:{svg:e},success:function(e){let t=JSON.parse(e);window.location.href="download.php?file="+t.basename}})}),$("#uploadfile").change(function(e){let t=e.target,i=new FileReader;i.onload=function(){i.result;$.post("upload.php",{data:i.result}).done(function(e){afterUpload(JSON.parse(e))})},i.readAsDataURL(t.files[0])});var image=draw.circle(0);function afterUpload(e){draw.size(e.width,e.height),image.remove(),image=draw.image(e.filename,function(e){image.size(draw.width(),draw.height()),$("#textfieldresize").attr("max",draw.width()),image.back(),setLogoPosition()})}var logo,textfield=draw.group();function handleText(){let e=[],t=[],i=$("#text").val().split(/\n/),a=["#449d2f","#255119"],n=[20,40],l=[30,60],o=[0,-8],d=0;textfield.remove(),textfield=draw.group().draggable();for(let r=0;r<i.length;r++){let f=i[r].toUpperCase(),s=0;"!"==f.substring(0,1)&&(f=f.substring(1),s=1);let g=a[s],h=n[s],w=l[s],p=o[s];e[r]=draw.text(f).fill(g).move(5,d+p),e[r].font({family:"Arvo",size:h,anchor:"left",leading:"1.5em",weight:"bold"}),t[r]=draw.rect(e[r].length()+10,w).fill("white").move(0,d),d+=w+4,textfield.add(t[r]).add(e[r])}setPositionOfTextfield(),$("#textfieldresize").val(textfield.width())}function setPositionOfTextfield(){textfield.x(info.x),textfield.y(info.y),textfield.size(info.size),textfield.front()}function setLogoPosition(){logo.x(draw.width()-logo.width()-10).y(10)}$("#text").bind("input propertychange",handleText),handleText(),textfield.on("dragend.namespace",function(e){info.x=textfield.x(),info.y=textfield.y()}),$("#textfieldresize").bind("input propertychange",function(){let e=parseInt($("#textfieldresize").val());textfield.size(e),info.size=e}),logo=draw.image("assets/sonnenblume.svg",function(e){logo.size(100,100).x(draw.width()-110).y(10)});var claim=draw.text("AM 15. MÄRZ GRÜN WÄHLEN.").fill("white").move(15,15);claim.font({family:"Arvo",size:15,anchor:"left",weight:600});var pin=draw.image("assets/pin.svg",function(e){pin.size(100).move(draw.width()/2,draw.height()/2),pin.draggable()});$("#subline").bind("input propertychange",handleSubline);var subline=draw.text("");function handleSubline(){subline.remove(),(subline=draw.text($("#subline").val().toUpperCase()).fill("white").move(15,draw.height()-24)).font({family:"Arvo",size:15,anchor:"left",weight:600})}