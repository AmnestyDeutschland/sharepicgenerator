var draw=SVG().addTo("#canvas").size(info.width,info.height);draw.rect(info.width,info.height).move(0,0).fill("green");var image,bgpic={width:480,height:320,filename:"fuchs.jpg"};function afterUpload(e){draw.size(e.width,e.height),image=draw.image(e.filename,function(e){image.size(draw.width(),draw.height()),$("#textfieldresize").attr("max",draw.width()),textfield.front()})}$(document).ready(function(){afterUpload(bgpic)}),$("#download").click(function(){let e=draw.svg();$.ajax({type:"POST",url:"savesvg.php",data:{svg:e},success:function(e){let t=JSON.parse(e);window.location.href="download.php?file="+t.basename}})}),$("#uploadfile").change(function(e){let t=e.target,i=new FileReader;i.onload=function(){i.result;$.post("upload.php",{data:i.result}).done(function(e){afterUpload(JSON.parse(e))})},i.readAsDataURL(t.files[0])});var textfield=draw.group(),text=draw.text("");function handleText(){let e=$("#text").val().split(/\n/);text.clear(),text=draw.text(function(t){for(let i=0;i<e.length;i++)t.tspan(e[i]).newLine()}),textfield.add(text),text.font({family:"Arvo",size:20,anchor:"middle",leading:"1.5em"}),setPositionOfTextfield(),$("#textfieldresize").val(textfield.width())}function setPositionOfTextfield(){textfield.x(info.x),textfield.y(info.y),textfield.size(info.size),textfield.front()}textfield.draggable(),$("#text").bind("input propertychange",handleText),handleText(),textfield.on("dragend.namespace",function(e){info.x=textfield.x(),info.y=textfield.y()}),$("#textfieldresize").bind("input propertychange",function(){let e=parseInt($("#textfieldresize").val());textfield.size(e),info.size=e});let circ=draw.circle(30).fill("white");